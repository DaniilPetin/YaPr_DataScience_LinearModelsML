# YaPr_DataScience_LinearModelsML
# Проект: Линейные модели в машинном обучении

## Описание проекта

Проект для IT-компании, которая выполняет на заказ проекты по машинному
обучению. К вам обратился фермер, владелец молочного хозяйства «Вольный
луг». Он хочет купить бурёнок, чтобы расширить поголовье стада коров.
Для этого он заключил выгодный контракт с ассоциацией пастбищ
«ЭкоФерма».

Условия позволяют фермеру очень тщательно отобрать коров. Он определяет
качество молока по строгой методике, и при этом ему нужно выполнять свой
план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка
давала не менее 6000 килограммов молока в год, а её надой был вкусным
--- строго по его критериям, ничуть не хуже. А продавцы и технологи так
и норовят приукрасить своих коров!

Поэтому он просит разработать модель машинного обучения, которая поможет
ему управлять рисками и принимать объективное решение о покупке.
«ЭкоФерма» готова предоставить подробные данные о своих коровах.
Необходимо создать две прогнозные модели для отбора бурёнок в поголовье:

1.  Первая будет прогнозировать возможный удой коровы (целевой признак
    Удой);

2.  Вторая --- рассчитывать вероятность получить вкусное молоко от
    коровы (целевой признак Вкус молока).

С помощью модели нужно отобрать коров по двум критериям:

- средний удой за год --- не менее 6000 килограммов;

- молоко должно быть вкусным.

## Описание данных

Датасеты:

- ferma_main.csv

- ferma_dad.csv

- cow_buy.csv

**Файл [ferma_main.csv]** содержит данные о стаде фермера на
текущий момент. Описание данных:

- id --- уникальный идентификатор коровы.

- Удой, кг --- масса молока, которую корова даёт в год (в килограммах).

- ЭКЕ (Энергетическая кормовая единица) --- показатель питательности
  корма коровы.

- Сырой протеин, г --- содержание сырого протеина в корме (в граммах).

- СПО (Сахаро-протеиновое соотношение) --- отношение сахара к протеину в
  корме коровы.

- Порода --- порода коровы.

- Тип пастбища --- ландшафт лугов, на которых паслась корова.

- порода папы_быка --- порода папы коровы.

- Жирность,% --- содержание жиров в молоке (в процентах).

- Белок,% --- содержание белков в молоке (в процентах).

- Вкус молока --- оценка вкуса по личным критериям фермера, бинарный
  признак (вкусно, не вкусно).

- Возраст --- возраст коровы, бинарный признак (менее_2_лет,
  более_2_лет).

**Файл [ferma_dad.csv]** хранит имя папы каждой коровы в
стаде фермера. Описание данных:

- id --- уникальный идентификатор коровы.

- Имя Папы --- имя папы коровы.

**Файл [cow_buy.csv]** --- это данные о коровах «ЭкоФермы»,
которых фермер хочет изучить перед покупкой. Описание данных:

- Порода --- порода коровы.

- Тип пастбища --- ландшафт лугов, на которых паслась корова.

- порода папы_быка --- порода папы коровы.

- Имя_папы --- имя папы коровы.

- Текущая_жирность,% --- содержание жиров в молоке (в процентах).

- Текущий_уровень_белок,% --- содержание белков в молоке (в процентах).

- Возраст --- возраст коровы, бинарный признак (менее_2_лет,
  более_2_лет).

Содержание белков и жиров в молоке указано на момент продажи --- когда
«ЭкоФерма» давала коровам свой корм.

Параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г
и СПО (Сахаро-протеиновое соотношение) отсутствуют. Технологи заказчика
пересмотрели подход к кормлению: для новых коров планируется увеличить
значения каждого из этих параметров на 5%.

Отсутствуют признаки Удой, кг и Вкус молока. Это целевые признаки,
именно их предстоит предсказать!

## Выполнение проекта

**Шаг 1.** **Загрузка и изучение** **данных**

1.  Загрузка данных в pandas. Файлы:

- ferma_main.csv

- ferma_dad.csv

- datacow_buy.csv

2.  Изучение данных. Определить, соответствуют ли они описанию задачи и
    стандартам оформления данных.

**Шаг 2.** **Предобработка данных**

Проверка данных на наличие пропусков и дубликатов. Проверка, корректны
ли типы данных у каждого признака.

**Шаг 3. Исследовательский** **анализ данных**

1.  Статистический анализ всех признаков.

2.  Графики для каждого признака.

3.  Выводы о данных

**Шаг 4.** **Корреляционный анализ признаков в датасете ferma_main.csv**

1.  Изучение взаимосвязи между признаками: расчет коэффициентов
    корреляции между всеми признаками.

2.  Построение диаграмм рассеяния scatterplot для признака Удой, кг и
    всех количественных признаков с учётом значения категориальных
    признаков.

3.  Выводы о взаимосвязи признаков.

**Шаг 5.** **Задача регрессии**

1.  Подготовка датасета ferma_main.csv и обучение на них первой модели
    LinearRegression.

- Целевой признак - Удой, кг.

- Отбор признаков

- Разбиение на тренировочную и тестовую выборки.

- Кодирование категориальных признаков с помощью OneHotEncoder.
  Масштабирование количественных признаков с помощью StandardScaler.

- Обучение модели линейной регрессии на подготовленных данных.

- Оценка качества модели на тестовой выборке: расчет R², анализ
  остатков.

- Выводы

2.  Подготовка данных с учётом связи входных признаков с целевым и
    обучение второй модели LinearRegression.

- Построение диаграмм рассеяния: на них можно увидеть, Исключить
  нелинейность, чтобы эти признаки были информативны для линейной
  регрессии.

- Повторить шаги из пункта 1 и создать вторую модель.

3.  Добавить в данные новый признак и обучить на них третью модель
    LinearRegression.

- Добавить признак Имя Папы из файла ferma_dad.csv, соединив его с
  остальными данными ferma_main.csv по ключу.

- Устранить нелинейность между признаками.

- Повторить шаги из пункта 1 и создать третью модель.

4.  Сравнить качество трёх моделей линейной регрессии, сопоставить их R²
    и остатки.

5.  Оценить качество каждой модели по трём метрикам: MSE, MAE, RMSE.

6.  С помощью лучшей модели спрогнозировать удой коров, которых фермер
    хочет купить. Данные о них находятся в датасете cow_buy.csv.

**Шаг 6. Задача классификации**

1.  Подготовить данные датасета ferma_main.csv и обучить на них модель
    LogisticRegression.

- Цеелвой признак - Вкус молока.

- Разбить данные на тренировочную и тестовую выборки.

- Кодирование категориальных признаков с помощью OneHotEncoder.
  Масштабирование количественных признаков с помощью StandardScaler.

- Обучение модели логистической регрессии на подготовленных данных.

- Оценка качества модели на тестовой выборке: расчет метрик accuracy,
  recall, precision.

- Матрица ошибок.

2.  Анализ модели логистической регрессии.

- Объяснить, какая ошибка критичнее всего при покупке коров: первого или
  второго рода.

- Свести критичную ошибку к нулю.

- Выводы

3.  С помощью обученной модели спрогнозировать вкус молока коров,
    которых фермер хочет купить. Данные о них находятся в датасете
    cow_buy.csv.

**Шаг 7. Итоговые выводы**
